<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Data</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <link rel="stylesheet" href="/styles/layout.css" type="text/css">
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css"
        integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="../styles/loginstyle.css?alter" charset="utf-8">
    <script src="https://code.highcharts.com/stock/highstock.js"></script>
    <script src="https://code.highcharts.com/stock/modules/exporting.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=News+Cycle" />
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <!--<script src="https://d3js.org/d3.v5.min.js" charset="utf-8"></script>-->
    <script src="https://d3js.org/d3-time.v1.min.js"></script>
    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <style>
            text:hover {
                stroke: black;
            }
          </style>
    <script src="http://d3js.org/d3.v3.min.js" charset="UTF-8"></script>
    <script type="text/javascript" src="/data/d3.layout.cloud.js"></script>
    <script type="text/javascript">
        //페이지가 로드되면 실행한다.
        $(document).ready(function () {
            $("#contents1").load("./data/stock-prices.html")
            $("#contents2").load("./data/pie_plot.html")
            //3는 div쪽에 있습니다
            $("#contents4").load("/data/stochastic_line_chart.html");
            //~이렇게 한줄만 해주면 알아서 contents에 testContents.html파일을 넣어 준다.
            $("#contents5").load("/data/bar_chart.html");

        });
    </script>
</head>

<body>
    <section id="sideMenu">
        <nav>
            <a href="/" class="active"><i class="fas fa-home"></i> Home</a>
            <a href="/user"><i class="far fa-user"></i> User</a>
            <a href="#"><i class="fas fa-cog"></i> Settings</a>
            <a href="#"><i class="far fa-bookmark"></i> Bookmark</a>
        </nav>
    </section>

    <section id="header">
        <div class="search-area">
            <i class="fa fa-search" aria-hidden="true"></i>
            <input type="text" name="" value="" class="search_in">
        </div>
    </section>

    <section>
        <!-- 맨위 주가 박스-->
        <div class="dashboard-1">
            <!--기업주가 / 환율-->
            <% var index_key = Object.keys(Index) %>
            <div class="realtime-index">
                <!-- kospi index  -->
                <div class="kospi">
                    <span class="index-name"><i class="fas fa-chart-line"></i> KOSPI </span>
                    <div class="kospi-current-index">
                        <%= Index[index_key[3]] %>
                    </div>
                    <!--상승,하락시 class="green", "red"-->
                    <span class="kospi-change">
                        <%= Index[index_key[7]] %>
                    </span>
                    <span class="kospi-state">

                    </span>
                </div>

                <!-- kosdaq index -->
                <div class="kosdaq">
                    <span class="index-name"><i class="fas fa-chart-line"></i> KOSDAQ </span>
                    <div class="kosdaq-current-index">
                        <%= Index[index_key[0]] %>
                    </div>
                    <!--상승,하락시 class="green", "red"-->
                    <span class="kosdaq-change">
                        <%= Index[index_key[1]] %>
                    </span>
                    <span class="kospaq-state">

                    </span>
                </div>

                <!-- kospi200 index -->
                <div class="kospi200">
                    <span class="index-name"><i class="fas fa-chart-line"></i> KOSPI200 </span>
                    <div class="kospi200-current-index">
                        <%= Index[index_key[4]] %>
                    </div>
                    <!--상승,하락시 class="green", "red"-->
                    <span class="kospi200-change">
                        <%= Index[index_key[5]] %>
                    </span>
                    <span class="kospi200-state">

                    </span>
                </div>

                <!-- 달러환율 -->
                <div class="dollar">
                    <span class="index-name"><i class="fas fa-chart-line"></i> 미국 USD </span>
                    <div class="dollar-currency">
                        <%= Index[index_key[9]] %></div>
                    <!--상승,하락시 class="green", "red"-->
                    <span class="dollar-change">
                        <%= Index[index_key[10]] %>%
                    </span>
                    <span class="dollar-state">
                        <%= Index[index_key[11]] %>
                    </span>
                </div>

                <!-- 엔화환율 -->
                <div class="jpy">
                    <span class="index-name"><i class="fas fa-chart-line"></i> 일본 JPY(100엔) </span>
                    <div class="jpy-currency">
                        <%= Index[index_key[12]] %>
                    </div>
                    <!--상승,하락시 class="green", "red"-->
                    <span class="jpy-change">
                        <%= Index[index_key[13]] %>%
                    </span>
                    <span class="jpy-state">
                        <%= Index[index_key[14]] %>
                    </span>
                </div>

                <!-- 유로환율 -->
                <div class="euro">
                    <span class="index-name"><i class="fas fa-chart-line"></i> 유럽연합 EUR </span>
                    <div class="euro-currency">
                        <%= Index[index_key[15]] %>
                    </div>
                    <!--상승,하락시 class="green", "red"-->
                    <span class="euro-change">
                        <%= Index[index_key[16]] %>%
                    </span>
                    <span class="euro-state">
                        <%= Index[index_key[17]] %>
                    </span>
                </div>

            </div>
        </div>
        </div>
    </section>

    <section>
        <div class="dashboard-2">
            <div class="dash-2-1">
                <!-- 기업주가 graph 들어갈부분 -->
                <div class="ent-graph">
                    <div id="contents1">

                    </div>
                </div>
                <!--기업데이터-->
                <div class="ent-data">
                    <% var data1_keys = Object.keys(Ent_data1) %>

                    <table class="table table-striped">
                        <!-- router쪽에서 보낸 Ent_data1 사용-->
                        <span style="font-size: 30px; color: #686866;" >기업데이터</span>
                        <tbody>
                            <tr>
                                <td class='ent_main_name'>현재가</td>
                                <td><%= Ent_data1[data1_keys[9]] %></td>
                                <td class='ent_main_name'>시가</td>
                                <td><%= Ent_data1[data1_keys[5]] %></td>
                            </tr>
                            <tr>
                                <td class='ent_main_name'>전일대비</td>
                                <td><%= Ent_data1[data1_keys[8]] %></td>
                                <td class='ent_main_name'>등락률(%)</td>
                                <td><%= Ent_data1[data1_keys[4]] %></td>
                            </tr>
                            <tr>
                                <td class='ent_main_name'>거래량</td>
                                <td><%= Ent_data1[data1_keys[2]] %></td>
                                <td class='ent_main_name'>시가총액</td>
                                <td><%= Ent_data1[data1_keys[6]] %></td>
                            </tr>
                            <tr>
                                <td class='ent_main_name'>고가</td>
                                <td><%= Ent_data1[data1_keys[3]] %></td>
                                <td class='ent_main_name'>저가</td>
                                <td><%= Ent_data1[data1_keys[7]] %></td>
                            </tr>
                            <tr>
                                <td class='ent_main_name'>PER(FnGuide)</td>
                                <td><%= Ent_data1[data1_keys[1]] %></td>
                                <td class='ent_main_name'>EPS(FnGuide)</td>
                                <td><%= Ent_data1[data1_keys[0]] %></td>
                            </tr>
                        </tbody>
                    </table>
                    <br><br>
                    <span style="font-family: Tmon몬소리; font-size: 30px; color: #686866;">분기별 실적</span>
                    <!-- 재무제표 데이터 최근 3개 분기 실적  -->
                    <table class="table table-striped3">
                        <thead>
                            <% var data2_keys = Object.keys(Ent_data2) %>
                            <% var data3_keys = Object.keys(Ent_data3) %>
                            <% var data4_keys = Object.keys(Ent_data4) %>
                            <% var data5_keys = Object.keys(Ent_data5) %>
                            <tr class='tabletag'>
                                <th>분기</th>
                                <th>매출액</th>
                                <th>영업이익</th>
                                <th>당기순이익</th>
                                <th>영업이익률(%)</th>
                            </tr>
                        </thead>
                        <br>
                        <tr>
                            <th scope="row">18.09</th>
                            <td><%= Ent_data2[data2_keys[1]] %></td>
                            <td><%= Ent_data2[data2_keys[2]] %></td>
                            <td><%= Ent_data2[data2_keys[0]] %></td>
                            <td><%= Ent_data2[data2_keys[3]] %>%</td>
                        </tr>

                        <tr>
                            <th scope="row">18.12</th>
                            <td><%= Ent_data3[data3_keys[1]] %></td>
                            <td><%= Ent_data3[data3_keys[2]] %></td>
                            <td><%= Ent_data3[data3_keys[0]] %></td>
                            <td><%= Ent_data3[data3_keys[3]] %>%</td>
                        </tr>
                        <tr>
                            <th scope="row">19.03</th>
                            <td><%= Ent_data4[data4_keys[1]] %></td>
                            <td><%= Ent_data4[data4_keys[2]] %></td>
                            <td><%= Ent_data4[data4_keys[0]] %></td>
                            <td><%= Ent_data4[data4_keys[3]] %>%</td>
                        </tr>
                        <tr>
                            <th scope="row">19.06</th>
                            <td><%= Ent_data5[data5_keys[1]] %></td>
                            <td><%= Ent_data5[data5_keys[2]] %></td>
                            <td><%= Ent_data5[data5_keys[0]] %></td>
                            <td><%= Ent_data5[data5_keys[3]] %>%</td>
                        </tr>
                        </tbody>
                    </table>

                </div>
                <!--연관기업 그래프 -->
                <div class="ent-relative">
                    <span style="font-family: Tmon몬소리; font-size: 30px; color: #686866;">연관 기업</span>
                    <div class="x_content" style="display: block;">
                        <table class="table table-striped2">
                            <% var re_keys1 = Object.keys(Re_data1) %>
                            <% var re_keys2 = Object.keys(Re_data2) %>
                            <% var re_keys3 = Object.keys(Re_data3) %>
                            <% var re_keys4 = Object.keys(Re_data4) %>
                            <% var re_keys5 = Object.keys(Re_data5) %>
                            <% var re_keys6 = Object.keys(Re_data6) %>
                            <thead>
                                <tr class='relate_tr'>
                                    <th>#</th>
                                    <th>기업명</th>
                                    <th>현재주가</th>
                                    <th>등락</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <th scope="row">1</th>
                                    <td><%= Re_data1[re_keys1[1]] %></td>
                                    <td><%= Re_data1[re_keys1[0]] %></td>
                                    <td><%= Re_data1[re_keys1[2]] %></td>
                                </tr>
                                <tr>
                                    <th scope="row">2</th>
                                    <td><%= Re_data2[re_keys2[1]] %></td>
                                    <td><%= Re_data2[re_keys2[0]] %></td>
                                    <td><%= Re_data2[re_keys2[2]] %></td>
                                </tr>
                                <tr>
                                    <th scope="row">3</th>
                                    <td><%= Re_data3[re_keys3[1]] %></td>
                                    <td><%= Re_data3[re_keys3[0]] %></td>
                                    <td><%= Re_data3[re_keys3[2]] %></td>
                                </tr>
                                <tr>
                                    <th scope="row">4</th>
                                    <td><%= Re_data4[re_keys4[1]] %></td>
                                    <td><%= Re_data4[re_keys4[0]] %></td>
                                    <td><%= Re_data4[re_keys4[2]] %></td>
                                </tr>
                                <tr>
                                    <th scope="row">5</th>
                                    <td><%= Re_data5[re_keys5[1]] %></td>
                                    <td><%= Re_data5[re_keys5[0]] %></td>
                                    <td><%= Re_data5[re_keys5[2]] %></td>
                                </tr>
                                <tr>
                                    <th scope="row">6</th>
                                    <td><%= Re_data6[re_keys6[1]] %></td>
                                    <td><%= Re_data6[re_keys6[0]] %></td>
                                    <td><%= Re_data6[re_keys6[2]] %></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="dash-2-2">
                <!-- pie chart-->
                <div class='tmp'>
                <div class="ent-info-part1" id=contents2>
                    <!--자동으로 들어감-->
                </div>
                </div>
                <!-- wordcloud -->
                <div class="ent-info-part4 id=contents3">
                    <!--이건 직접 들어감-->
                    <div id="cloud"></div>
                    <script type="text/javascript">
                        var weight = 1 / 20,   // change me
                            width = 610, // origin = 960
                            height = 525;
                        // 반드시 csv는 utf-8 쉼표분리로 저장하기
                        var fill = d3.scale.category20();
                        d3.csv("./news_word.csv", function (d) {
                            return {
                                text: d.adj, // 반드시 csv의 컬럼명으로 변경해주세요
                                size: +d.freq * weight // 반드시 csv의 컬럼명으로 변경해주세요
                            }
                        },
                            function (data) {
                                d3.layout.cloud().size([width, height]).words(data)
                                    //.rotate(function() { return ~~(Math.random() * 2) * 90; })
                                    .rotate(0)
                                    .font("Impact")
                                    .fontSize(function (d) { return d.size; })
                                    .on("end", draw)
                                    .start();

                                function draw(words) {
                                    d3.select("#cloud").append("svg")
                                        .attr("width", width)
                                        .attr("height", height)
                                        .style('background-color', 'ffffff') //#3C3C3C , 000000 ,
                                        .append("g")
                                        .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")")
                                        .selectAll("text")
                                        .data(words)
                                        .enter().append("text")
                                        .style("font-size", function (d) { return d.size + "px"; })
                                        .style("font-family", "Impact")
                                        .style("fill", function (d, i) { return fill(i); })
                                        .attr("text-anchor", "middle")
                                        .attr("transform", function (d) {
                                            return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
                                        })
                                        .text(function (d) { return d.text; });
                                }
                            });
                    </script>

                </div>
            </div>
            <!--뉴스-- 내용 링크 제목 시간 출처-->
            <div class="ent-info-part2" id="part2">
                <% var news_keys1 = Object.keys(News_data1) %>
                <% var news_keys2 = Object.keys(News_data2) %>
                <% var news_keys3 = Object.keys(News_data3) %>
                <% var news_keys4 = Object.keys(News_data4) %>
                <% var news_keys5 = Object.keys(News_data5) %>
                <% var news_keys6 = Object.keys(News_data6) %>
                <% var news_keys7 = Object.keys(News_data7) %>
                <% var news_keys8 = Object.keys(News_data8) %>
                <% var news_keys9 = Object.keys(News_data9) %>
                <% var news_keys10 = Object.keys(News_data10) %>
                <ul class="list-unstyled timeline widget">
                    <li>
                        <div class="block">
                            <div class="block_content">
                                <h4 class="mytitle">
                                    <a href="<%= News_data1[news_keys1[1]] %>" target="_blank"
                                        style="color:#6000D2"><%= News_data1[news_keys1[3]] %></a>
                                </h4>
                                <div class="byline">
                                    출처: <a><%= News_data1[news_keys1[4]] %>
                                        &nbsp</a><span> 날짜:<%= News_data1[news_keys1[2]] %>전</span>
                                </div>
                                <h6>/<p class="excerpt"><%= News_data1[news_keys1[0]] %></p></h6>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="block">
                            <div class="block_content">
                                <h4 class="mytitle">
                                    <a href="<%= News_data2[news_keys2[1]] %>" target="_blank"
                                        style="color:#6000D2"><%= News_data2[news_keys2[3]] %></a>
                                </h4>
                                <div class="byline">
                                    출처: <a><%= News_data2[news_keys2[4]] %>
                                        &nbsp</a><span> 날짜:<%= News_data2[news_keys2[2]] %>전</span>
                                </div>
                                <p class="excerpt"><%= News_data2[news_keys2[0]] %></p>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="block">
                            <div class="block_content">
                                <h4 class="mytitle">
                                    <a href="<%= News_data3[news_keys3[1]] %>" target="_blank"
                                        style="color:#6000D2"><%= News_data3[news_keys3[3]] %></a>
                                </h4>
                                <div class="byline">
                                    출처: <a><%= News_data3[news_keys3[4]] %>
                                        &nbsp</a><span> 날짜:<%= News_data3[news_keys3[2]] %>전</span>
                                </div>
                                <p class="excerpt"><%= News_data3[news_keys3[0]] %></p>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="block">
                            <div class="block_content">
                                <h4 class="title">
                                    <a href="<%= News_data4[news_keys4[1]] %>" target="_blank"
                                        style="color:#6000D2"><%= News_data4[news_keys4[3]] %></a>
                                </h4>
                                <div class="byline">
                                    출처: <a><%= News_data4[news_keys4[4]] %>
                                        &nbsp</a><span> 날짜:<%= News_data4[news_keys4[2]] %>전</span>
                                </div>
                                <p class="excerpt"><%= News_data4[news_keys4[0]] %></p>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="block">
                            <div class="block_content">
                                <h4 class="title">
                                    <a href="<%= News_data5[news_keys5[1]] %>" target="_blank"
                                        style="color:#6000D2"><%= News_data5[news_keys5[3]] %></a>
                                </h4>
                                <div class="byline">
                                    출처: <a><%= News_data5[news_keys5[4]] %>
                                        &nbsp</a><span> 날짜:<%= News_data5[news_keys5[2]] %>전</span>
                                </div>
                                <p class="excerpt"><%= News_data5[news_keys5[0]] %></p>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="block">
                            <div class="block_content">
                                <h4 class="title">
                                    <a href="<%= News_data6[news_keys6[1]] %>" target="_blank"
                                        style="color:#6000D2"><%= News_data6[news_keys6[3]] %></a>
                                </h4>
                                <div class="byline">
                                    출처: <a><%= News_data6[news_keys6[4]] %>
                                        &nbsp</a><span> 날짜:<%= News_data6[news_keys6[2]] %>전</span>
                                </div>
                                <p class="excerpt"><%= News_data6[news_keys6[0]] %></p>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="block">
                            <div class="block_content">
                                <h4 class="title">
                                    <a <%= News_data7[news_keys7[1]] %> target="_blank"
                                        style="color:#6000D2"><%= News_data7[news_keys7[3]] %></a>
                                </h4>
                                <div class="byline">
                                    출처: <a><%= News_data7[news_keys7[4]] %>
                                        &nbsp</a><span> 날짜:<%= News_data7[news_keys7[2]] %>전</span>
                                </div>
                                <p class="excerpt"><%= News_data7[news_keys7[0]] %></p>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="block">
                            <div class="block_content">
                                <h4 class="title">
                                    <a href="<%= News_data8[news_keys8[1]] %>" target="_blank"
                                        style="color:#6000D2"><%= News_data8[news_keys8[3]] %></a>
                                </h4>
                                <div class="byline">
                                    출처: <a><%= News_data8[news_keys8[4]] %>
                                        &nbsp</a><span> 날짜:<%= News_data8[news_keys8[2]] %>전</span>
                                </div>
                                <p class="excerpt"><%= News_data8[news_keys8[0]] %></p>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="block">
                            <div class="block_content">
                                <h4 class="title">
                                    <a href="<%= News_data9[news_keys9[1]] %>" target="_blank"
                                        style="color:#6000D2"><%= News_data9[news_keys9[3]] %></a>
                                </h4>
                                <div class="byline">
                                    출처: <a><%= News_data9[news_keys9[4]] %>
                                        &nbsp</a><span> 날짜:<%= News_data9[news_keys9[2]] %>전</span>
                                </div>
                                <p class="excerpt"><%= News_data9[news_keys9[0]] %></p>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="block">
                            <div class="block_content">
                                <h4 class="title">
                                    <a href="<%= News_data10[news_keys10[1]] %>" target="_blank"
                                        style="color:#6000D2"><%= News_data10[news_keys1[3]] %></a>
                                </h4>
                                <div class="byline">
                                    출처: <a><%= News_data10[news_keys10[4]] %>cmd
                                        &nbsp</a><span> 날짜:<%= News_data10[news_keys10[2]] %>전</span>
                                </div>
                                <p class="excerpt"><%= News_data10[news_keys10[0]] %></p>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>

        <div class="ent-info-part3" id="contents4">
            <!--여기에 자동으로 들어감 (위에 로드때문에)-->
        </div>

        <div class="ent-info-part5" id="contents5">
            <!--여기에 자동으로 들어감 (위에 로드때문에)-->
        </div>

    </section>

</body>

</html>